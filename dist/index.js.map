{"version":3,"file":"index.js","sources":["../src/rgb.ts","../src/hsv.ts","../src/hsluv.ts"],"sourcesContent":["export interface Color {\r\n    toRgb(): Rgb\r\n    toStyle(): string\r\n}\r\n\r\nexport class Rgb implements Color {\r\n    static fromCss(css: string): Rgb | null {\r\n        css = css.replace(/[ \\t]/, \"\")\r\n        if (css.startsWith(\"rgb(\")) return parseRgbCss(css.substr(4, css.length - 5))\r\n        if (css.startsWith(\"#\")) {\r\n            return parseHexCss(css.substr(1))\r\n        }\r\n        return parseHexCss(css)\r\n    }\r\n\r\n    constructor(readonly r: number, readonly g: number, readonly b: number) {}\r\n\r\n    is(other: Rgb): boolean {\r\n        return this.r === other.r && this.g === other.g && this.b === other.b\r\n    }\r\n\r\n    toRgb(): Rgb {\r\n        return this\r\n    }\r\n\r\n    with({ r, g, b }: { readonly r?: number; readonly g?: number; readonly b?: number }): Rgb {\r\n        return new Rgb(\r\n            r !== undefined ? r : this.r,\r\n            g !== undefined ? g : this.g,\r\n            b !== undefined ? b : this.b,\r\n        )\r\n    }\r\n\r\n    toStyle(): string {\r\n        return `rgb(${floatToByte(this.r)},${floatToByte(this.g)},${floatToByte(this.b)})`\r\n    }\r\n\r\n    toLinear(): RgbLinear {\r\n        return new RgbLinear(toLinear(this.r), toLinear(this.g), toLinear(this.b))\r\n    }\r\n\r\n    toString(): string {\r\n        return \"Rgb(\" + this.r + \", \" + this.g + \", \" + this.b + \")\"\r\n    }\r\n}\r\n\r\nexport class RgbLinear {\r\n    static White = new RgbLinear(1, 1, 1)\r\n    static Black = new RgbLinear(0, 0, 0)\r\n\r\n    constructor(readonly r: number, readonly g: number, readonly b: number) {}\r\n\r\n    is(other: RgbLinear): boolean {\r\n        return this.r === other.r && this.g === other.g && this.b === other.b\r\n    }\r\n\r\n    with({\r\n        r,\r\n        g,\r\n        b,\r\n    }: {\r\n        readonly r?: number\r\n        readonly g?: number\r\n        readonly b?: number\r\n    }): RgbLinear {\r\n        return new RgbLinear(\r\n            r !== undefined ? r : this.r,\r\n            g !== undefined ? g : this.g,\r\n            b !== undefined ? b : this.b,\r\n        )\r\n    }\r\n\r\n    mix(pct: number, other: RgbLinear): RgbLinear {\r\n        return new RgbLinear(\r\n            lerp(pct, this.r, other.r),\r\n            lerp(pct, this.g, other.g),\r\n            lerp(pct, this.b, other.b),\r\n        )\r\n    }\r\n\r\n    lighten(pct: number): RgbLinear {\r\n        return this.mix(pct, RgbLinear.White)\r\n    }\r\n\r\n    darken(pct: number): RgbLinear {\r\n        return this.mix(pct, RgbLinear.Black)\r\n    }\r\n\r\n    fromLinear(): Rgb {\r\n        return new Rgb(fromLinear(this.r), fromLinear(this.g), fromLinear(this.b))\r\n    }\r\n\r\n    toString(): string {\r\n        return \"LinearRgb(\" + this.r + \", \" + this.g + \", \" + this.b + \")\"\r\n    }\r\n}\r\n\r\nfunction toLinear(c: number) {\r\n    return c > 0.04045 ? ((c + 0.055) / 1.055) ** 2.4 : c / 12.92\r\n}\r\n\r\nfunction fromLinear(c: number) {\r\n    return c <= 0.0031308 ? c * 12.92 : Math.pow(c * 1.055, 1.0 / 2.4) - 0.055\r\n}\r\n\r\nfunction floatToByte(x: number): number {\r\n    return (x * 255.9999999) | 0\r\n}\r\n\r\nfunction validateRgb(r: number, g: number, b: number): Rgb | null {\r\n    if (isNaN(r) || !isFinite(r)) return null\r\n    if (isNaN(g) || !isFinite(g)) return null\r\n    if (isNaN(b) || !isFinite(b)) return null\r\n\r\n    return new Rgb(r, g, b)\r\n}\r\n\r\nfunction parseRgbCss(css: string): Rgb | null {\r\n    const vals = css.split(\",\")\r\n    if (vals.length !== 3) return null\r\n\r\n    const r = Number.parseFloat(vals[0]) / 255\r\n    const g = Number.parseFloat(vals[1]) / 255\r\n    const b = Number.parseFloat(vals[2]) / 255\r\n\r\n    return validateRgb(r, g, b)\r\n}\r\n\r\nfunction parseHexCss(css: string): Rgb | null {\r\n    if (css.length === 3) {\r\n        const r = parseHex(css[0]) / 15\r\n        const g = parseHex(css[1]) / 15\r\n        const b = parseHex(css[2]) / 15\r\n        return validateRgb(r, g, b)\r\n    }\r\n    if (css.length === 6) {\r\n        const r = parseHexPair(css[0], css[1])\r\n        const g = parseHexPair(css[2], css[3])\r\n        const b = parseHexPair(css[4], css[5])\r\n        return validateRgb(r, g, b)\r\n    }\r\n    return null\r\n}\r\n\r\nfunction parseHexPair(l: string, r: string): number {\r\n    return (parseHex(l) * 16 + parseHex(r)) / 255\r\n}\r\n\r\nfunction parseHex(hex: string): number {\r\n    const lcHex = hex.toLowerCase()\r\n    switch (lcHex) {\r\n        case \"0\":\r\n            return 0\r\n        case \"1\":\r\n            return 1\r\n        case \"2\":\r\n            return 2\r\n        case \"3\":\r\n            return 3\r\n        case \"4\":\r\n            return 4\r\n        case \"5\":\r\n            return 5\r\n        case \"6\":\r\n            return 6\r\n        case \"7\":\r\n            return 7\r\n        case \"8\":\r\n            return 8\r\n        case \"9\":\r\n            return 9\r\n        case \"a\":\r\n            return 10\r\n        case \"b\":\r\n            return 11\r\n        case \"c\":\r\n            return 12\r\n        case \"d\":\r\n            return 13\r\n        case \"e\":\r\n            return 14\r\n        case \"f\":\r\n            return 15\r\n        default:\r\n            return NaN\r\n    }\r\n}\r\n\r\nfunction lerp(pct: number, from: number, to: number): number {\r\n    return from + pct * to\r\n}\r\n","import { Color, Rgb } from \"./rgb\"\r\n\r\nexport class Hsv implements Color {\r\n    private __cachedRgb: Rgb | null = null\r\n\r\n    constructor(readonly h: number, readonly s: number, readonly v: number) {}\r\n\r\n    is(other: Hsv): boolean {\r\n        return this.h === other.h && this.s === other.s && this.v === other.v\r\n    }\r\n\r\n    toRgb(): Rgb {\r\n        if (this.__cachedRgb === null) {\r\n            this.__cachedRgb = hsvToRgb(this)\r\n        }\r\n        return this.__cachedRgb\r\n    }\r\n\r\n    toStyle(): string {\r\n        return this.toRgb().toStyle()\r\n    }\r\n\r\n    with({ h, s, v }: { readonly h?: number; readonly s?: number; readonly v?: number }): Hsv {\r\n        return new Hsv(\r\n            h !== undefined ? h : this.h,\r\n            s !== undefined ? s : this.s,\r\n            v !== undefined ? v : this.v,\r\n        )\r\n    }\r\n\r\n    toString() {\r\n        return \"Hsv(\" + this.h + \", \" + this.s + \", \" + this.v + \")\"\r\n    }\r\n}\r\n\r\nexport function rgbToHsv({ r, g, b }: Rgb): Hsv {\r\n    const maxValue = Math.max(r, g, b)\r\n    const minValue = Math.min(r, g, b)\r\n    const d = maxValue - minValue\r\n    const s = maxValue === 0 ? 0 : d / maxValue\r\n    let h: number\r\n\r\n    switch (maxValue) {\r\n        case minValue:\r\n            h = 0\r\n            break\r\n        case r:\r\n            h = (g - b) / d + (g < b ? 6.0 : 0.0)\r\n            break\r\n        case g:\r\n            h = (b - r) / d + 2.0\r\n            break\r\n        default:\r\n            h = (r - g) / d + 4.0\r\n            break\r\n    }\r\n    return new Hsv(h / 6, s, maxValue)\r\n}\r\n\r\nexport function hsvToRgb({ h, s, v }: Hsv): Rgb {\r\n    const i = (h * 6) | 0\r\n    const f = h * 6 - i\r\n    const p = v * (1 - s)\r\n    const q = v * (1 - f * s)\r\n    const t = v * (1 - (1 - f) * s)\r\n\r\n    let r: number\r\n    let g: number\r\n    let b: number\r\n    switch (i % 6) {\r\n        case 0:\r\n            r = v\r\n            g = t\r\n            b = p\r\n            break\r\n        case 1:\r\n            r = q\r\n            g = v\r\n            b = p\r\n            break\r\n        case 2:\r\n            r = p\r\n            g = v\r\n            b = t\r\n            break\r\n        case 3:\r\n            r = p\r\n            g = q\r\n            b = v\r\n            break\r\n        case 4:\r\n            r = t\r\n            g = p\r\n            b = v\r\n            break\r\n        default:\r\n            r = v\r\n            g = p\r\n            b = q\r\n            break\r\n    }\r\n    return new Rgb(r, g, b)\r\n}\r\n","import { Color, Rgb } from \"./rgb\"\r\n\r\n/* Hsluv vs Hsl:\r\n    http://www.hsluv.org/comparison/\r\n\r\n    Implementation based on:\r\n   https://github.com/dvdplm/rust-hsluv/blob/master/src/lib.rs\r\n   https://github.com/hsluv/hsluv-csharp/blob/master/Hsluv/Hsluv.cs\r\n\r\n   TODO: Consider having all the transformation functions taking a mutable vector as input and modifying it, rather than creating a new one.\r\n\r\n   the pure transformation functions can be implemented on top of these efficient impure functions\r\n\r\n   it would be a loss in performance for one-step transformations like rgb -> rgbLinear\r\n   but it would be a performance gain for multi-step transformations such as rgb -> hsluv\r\n*/\r\n\r\nclass Vec2 {\r\n    // @ts-ignore\r\n    private readonly nominal: void\r\n    constructor(readonly x: number, readonly y: number) {}\r\n}\r\n\r\nclass Vec3 {\r\n    // @ts-ignore\r\n    private readonly nominal: void\r\n    constructor(readonly x: number, readonly y: number, readonly z: number) {}\r\n}\r\n\r\nexport class Luv {\r\n    // @ts-ignore\r\n    private readonly nominal: void\r\n    constructor(readonly l: number, readonly u: number, readonly v: number) {}\r\n}\r\n\r\nexport class Hsluv implements Color {\r\n    private __cachedRgb: Rgb | null = null\r\n\r\n    constructor(readonly h: number, readonly s: number, readonly l: number) {}\r\n\r\n    is(other: Hsluv): boolean {\r\n        return this.h === other.h && this.s === other.s && this.l === other.l\r\n    }\r\n\r\n    with({ h, s, l }: { readonly h?: number; readonly s?: number; readonly l?: number }): Hsluv {\r\n        return new Hsluv(\r\n            h !== undefined ? h : this.h,\r\n            s !== undefined ? s : this.s,\r\n            l !== undefined ? l : this.l,\r\n        )\r\n    }\r\n\r\n    toRgb(): Rgb {\r\n        if (this.__cachedRgb === null) {\r\n            this.__cachedRgb = hsluvToRgb(this)\r\n        }\r\n        return this.__cachedRgb\r\n    }\r\n\r\n    toStyle(): string {\r\n        const style = this.toRgb().toStyle()\r\n        return style\r\n    }\r\n\r\n    toString() {\r\n        return \"Hsluv(\" + this.h + \", \" + this.s + \", \" + this.l + \")\"\r\n    }\r\n}\r\n\r\nexport class Hpluv implements Color {\r\n    private __cachedRgb: Rgb | null = null\r\n\r\n    constructor(readonly h: number, readonly p: number, readonly l: number) {}\r\n\r\n    is(other: Hpluv): boolean {\r\n        return this.h === other.h && this.p === other.p && this.l === other.l\r\n    }\r\n\r\n    with({ h, p, l }: { readonly h?: number; readonly p?: number; readonly l?: number }): Hpluv {\r\n        return new Hpluv(\r\n            h !== undefined ? h : this.h,\r\n            p !== undefined ? p : this.p,\r\n            l !== undefined ? l : this.l,\r\n        )\r\n    }\r\n\r\n    toRgb(): Rgb {\r\n        if (this.__cachedRgb === null) {\r\n            this.__cachedRgb = hpluvToRgb(this)\r\n        }\r\n        return this.__cachedRgb\r\n    }\r\n\r\n    toStyle(): string {\r\n        return this.toRgb().toStyle()\r\n    }\r\n\r\n    toString() {\r\n        return \"Hsv(\" + this.h + \", \" + this.p + \", \" + this.l + \")\"\r\n    }\r\n}\r\n\r\nexport class Lch {\r\n    // @ts-ignore\r\n    private readonly nominal: void\r\n    constructor(readonly l: number, readonly c: number, readonly h: number) {}\r\n}\r\n\r\nexport class Xyz {\r\n    // @ts-ignore\r\n    private readonly nominal: void\r\n    constructor(readonly x: number, readonly y: number, readonly z: number) {}\r\n}\r\n\r\ninterface Mat3 {\r\n    readonly length: 3\r\n    readonly [0]: Vec3\r\n    readonly [1]: Vec3\r\n    readonly [2]: Vec3\r\n}\r\n\r\n/*\r\n    m =\r\n        [ 3.240969941904521, -1.537383177570093, -0.498610760293\r\n        , -0.96924363628087, 1.87596750150772, 0.041555057407175\r\n        , 0.055630079696993, -0.20397695888897, 1.056971514242878\r\n        ]\r\n\r\n    mInv =\r\n        [ 0.41239079926595, 0.35758433938387, 0.18048078840183\r\n        , 0.21263900587151, 0.71516867876775, 0.072192315360733\r\n        , 0.019330818715591, 0.11919477979462, 0.95053215224966\r\n        ]\r\n*/\r\n\r\nconst m: Mat3 = [\r\n    new Vec3(3.240969941904521, -1.537383177570093, -0.498610760293),\r\n    new Vec3(-0.96924363628087, 1.87596750150772, 0.041555057407175),\r\n    new Vec3(0.055630079696993, -0.20397695888897, 1.056971514242878),\r\n]\r\n\r\nconst mInv: Mat3 = [\r\n    new Vec3(0.41239079926595, 0.35758433938387, 0.18048078840183),\r\n    new Vec3(0.21263900587151, 0.71516867876775, 0.072192315360733),\r\n    new Vec3(0.019330818715591, 0.11919477979462, 0.95053215224966),\r\n]\r\n\r\nconst refY: number = 1.0\r\n\r\nconst refU: number = 0.19783000664283\r\n\r\nconst refV: number = 0.46831999493879\r\n\r\nconst kappa: number = 903.2962962\r\n\r\nconst epsilon: number = 0.0088564516\r\n\r\nfunction degreesToRadians(deg: number) {\r\n    return (deg * Math.PI) / 180.0\r\n}\r\n\r\nfunction radiansToDegrees(rad: number) {\r\n    return (rad * 180.0) / Math.PI\r\n}\r\n\r\nfunction lengthOfRayUntilIntersect(theta: number, vec: Vec2) {\r\n    const length = vec.y / (Math.sin(theta) - vec.x * Math.cos(theta))\r\n    if (length < 0.0) {\r\n        return -0.0001\r\n    } else {\r\n        return length\r\n    }\r\n}\r\n\r\ntype ZeroToTwo = 0 | 1 | 2\r\n\r\nfunction getBounds(l: number): ReadonlyArray<Vec2> {\r\n    const sub1 = (l + 16) ** 3 / 1560896\r\n    const sub2 = sub1 > epsilon ? sub1 : l / kappa\r\n\r\n    const bounds = new Array<Vec2>(3 * 2)\r\n\r\n    // TODO: unwrap loop\r\n    // can I also inline the matrix's values?\r\n    for (let c = 0; c < 3; c++) {\r\n        const m1 = m[c as ZeroToTwo].x\r\n        const m2 = m[c as ZeroToTwo].y\r\n        const m3 = m[c as ZeroToTwo].z\r\n\r\n        for (let t = 0; t < 2; t++) {\r\n            const top1 = (284517 * m1 - 94839 * m3) * sub2\r\n            const top2 = (838422 * m3 + 769860 * m2 + 731718 * m1) * l * sub2 - 769860 * t * l\r\n            const bottom = (632260 * m3 - 126452 * m2) * sub2 + 126452 * t\r\n            bounds[c * 2 + t] = new Vec2(top1 / bottom, top2 / bottom)\r\n        }\r\n    }\r\n\r\n    return bounds\r\n}\r\n\r\nfunction distance(x: number, y: number) {\r\n    return Math.sqrt(x * x + y * y)\r\n}\r\n\r\nfunction intersectLineLine(vec1: Vec2, vec2: Vec2) {\r\n    return (vec1.y - vec2.y) / (vec2.x - vec1.x)\r\n}\r\n\r\nfunction maxSafeChromaForL(l: number) {\r\n    const bounds = getBounds(l)\r\n\r\n    let min = Number.MAX_VALUE\r\n\r\n    for (let i = 0; i < 2; ++i) {\r\n        const line = bounds[i]\r\n\r\n        // TODO: inline\r\n        const x = intersectLineLine(line, new Vec2(-1 / line.x, 0))\r\n\r\n        const length = distance(x, line.y + x * line.x)\r\n\r\n        if (length < min) min = length\r\n    }\r\n\r\n    return min\r\n}\r\n\r\nfunction maxChromaForLH(l: number, h: number) {\r\n    const hrad = (h / 360.0) * Math.PI * 2.0\r\n    const bounds = getBounds(l)\r\n\r\n    let min = Number.MAX_VALUE\r\n    for (let i = 0; i < bounds.length; i++) {\r\n        // TODO: inline\r\n        const length = lengthOfRayUntilIntersect(hrad, bounds[i])\r\n\r\n        if (length >= 0 && length < min) min = length\r\n    }\r\n    return min\r\n}\r\n\r\nfunction funF(t: number) {\r\n    if (t > epsilon) {\r\n        return 116 * (t / refY) ** (1 / 3) - 16\r\n    } else {\r\n        return (t / refY) * kappa\r\n    }\r\n}\r\n\r\nfunction funFInv(t: number) {\r\n    if (t > 8.0) {\r\n        return (refY * ((t + 16.0) / 116.0)) ** 3.0\r\n    } else {\r\n        return (refY * t) / kappa\r\n    }\r\n}\r\n\r\nfunction fromLinear(c: number) {\r\n    if (c <= 0.0031308) {\r\n        return 12.92 * c\r\n    } else {\r\n        return 1.055 * c ** (1.0 / 2.4) - 0.055\r\n    }\r\n}\r\n\r\nexport function luvToLch({ l, u, v }: Luv): Lch {\r\n    const c = distance(u, v)\r\n    if (c < 0.00000001) {\r\n        return new Lch(l, c, 0)\r\n    }\r\n    const h = radiansToDegrees(Math.atan2(v, u))\r\n    if (h < 0.0) {\r\n        return new Lch(l, c, h + 360)\r\n    } else {\r\n        return new Lch(l, c, h)\r\n    }\r\n}\r\n\r\nexport function lchToLuv({ l, c, h }: Lch): Luv {\r\n    const hrad = degreesToRadians(h)\r\n    const u = Math.cos(hrad) * c\r\n    const v = Math.sin(hrad) * c\r\n    return new Luv(l, u, v)\r\n}\r\n\r\nfunction mat3map<a>(fn: (x: Vec3) => a, mat: Mat3): Readonly<[a, a, a]> {\r\n    return [fn(mat[0]), fn(mat[1]), fn(mat[2])]\r\n}\r\n\r\nexport function rgbToXyz(rgb: Rgb): Xyz {\r\n    const lrgb = rgb.toLinear()\r\n    // todo: unwrap map\r\n    const xyz = mat3map(vec => lrgb.r * vec.x + lrgb.g * vec.y + lrgb.b * vec.z, mInv)\r\n    return new Xyz(xyz[0], xyz[1], xyz[2])\r\n}\r\n\r\nexport function xyzToRgb(xyz: Xyz): Rgb {\r\n    // todo: unwrap map\r\n    const rgb = mat3map(vec => fromLinear(xyz.x * vec.x + xyz.y * vec.y + xyz.z * vec.z), m)\r\n    return new Rgb(rgb[0], rgb[1], rgb[2])\r\n}\r\n\r\nexport function lchToHsluv({ l, c, h }: Lch): Hsluv {\r\n    if (l > 99.9999999) {\r\n        return new Hsluv(h, 0, 100)\r\n    }\r\n    if (l < 0.00000001) {\r\n        return new Hsluv(h, 0, 0)\r\n    }\r\n    const mx = maxChromaForLH(l, h)\r\n    const s = (c / mx) * 100\r\n    return new Hsluv(h, s, l)\r\n}\r\n\r\nexport function hsluvToLch({ h, s, l }: Hsluv): Lch {\r\n    if (l > 99.9999999) {\r\n        return new Lch(100, 0.0, h)\r\n    }\r\n    if (l < 0.00000001) {\r\n        return new Lch(0, 0, h)\r\n    }\r\n    const mx = maxChromaForLH(l, h)\r\n    const c = (mx / 100) * s\r\n    return new Lch(l, c, h)\r\n}\r\n\r\nexport function lchToHpluv({ l, c, h }: Lch): Hpluv {\r\n    if (l > 99.9999999) {\r\n        return new Hpluv(h, 0, 100)\r\n    }\r\n    if (l < 0.00000001) {\r\n        return new Hpluv(h, 0, 0)\r\n    }\r\n\r\n    const mx = maxSafeChromaForL(l)\r\n    const p = (c / mx) * 100\r\n    return new Hpluv(h, p, l)\r\n}\r\n\r\nexport function hpluvToLch({ h, p, l }: Hpluv): Lch {\r\n    if (l > 99.9999999) {\r\n        return new Lch(100, 0, h)\r\n    }\r\n    if (l < 0.00000001) {\r\n        return new Lch(0, 0, h)\r\n    }\r\n    const mx = maxSafeChromaForL(l)\r\n    const c = (mx / 100) * p\r\n    return new Lch(l, c, h)\r\n}\r\n\r\nexport function luvToRgb(luv: Luv): Rgb {\r\n    return xyzToRgb(luvToXyz(luv))\r\n}\r\n\r\nexport function rgbToLch(rgb: Rgb): Lch {\r\n    return luvToLch(xyzToLuv(rgbToXyz(rgb)))\r\n}\r\n\r\nexport function lchToRgb(lch: Lch): Rgb {\r\n    return xyzToRgb(luvToXyz(lchToLuv(lch)))\r\n}\r\n\r\nexport function rgbToHsluv(rgb: Rgb): Hsluv {\r\n    return lchToHsluv(rgbToLch(rgb))\r\n}\r\n\r\nexport function hsluvToRgb(hsluv: Hsluv): Rgb {\r\n    return lchToRgb(hsluvToLch(hsluv))\r\n}\r\n\r\nexport function rgbToHpluv(rgb: Rgb): Hpluv {\r\n    return lchToHpluv(rgbToLch(rgb))\r\n}\r\n\r\nexport function hpluvToRgb(hpluv: Hpluv): Rgb {\r\n    return lchToRgb(hpluvToLch(hpluv))\r\n}\r\n\r\nexport function xyzToLuv({ x, y, z }: Xyz): Luv {\r\n    if (x === 0 && y === 0 && z === 0) {\r\n        return new Luv(0, 0, 0)\r\n    }\r\n    const l = funF(y)\r\n    if (l === 0) {\r\n        return new Luv(0, 0, 0)\r\n    }\r\n\r\n    const u = 13 * l * ((4 * x) / (x + 15 * y + 3 * z) - refU)\r\n    const v = 13 * l * ((9 * y) / (x + 15 * y + 3 * z) - refV)\r\n    return new Luv(l, u, v)\r\n}\r\n\r\nexport function luvToXyz({ l, u, v }: Luv): Xyz {\r\n    if (l === 0) {\r\n        return new Xyz(0, 0, 0)\r\n    }\r\n\r\n    const initU = u / (13 * l) + refU\r\n    const initV = v / (13 * l) + refV\r\n\r\n    const y = funFInv(l) * refY\r\n    const x = 0 - (9 * y * initU) / ((initU - 4) * initV - initU * initV)\r\n    const z = (9 * y - 15 * initV * y - initV * x) / (3 * initV)\r\n    return new Xyz(x, y, z)\r\n}\r\n\r\nexport function toGray({ r, g, b }: Rgb): Rgb {\r\n    const gray = Math.sqrt(0.299 * r * r + 0.587 * g * g + 0.114 * b * b)\r\n    return new Rgb(gray, gray, gray)\r\n}\r\n"],"names":["fromLinear"],"mappings":";;;;MAKa,GAAG;IAUZ,YAAqB,CAAS,EAAW,CAAS,EAAW,CAAS;QAAjD,MAAC,GAAD,CAAC,CAAQ;QAAW,MAAC,GAAD,CAAC,CAAQ;QAAW,MAAC,GAAD,CAAC,CAAQ;KAAI;IAT1E,OAAO,OAAO,CAAC,GAAW;QACtB,GAAG,GAAG,GAAG,CAAC,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC,CAAA;QAC9B,IAAI,GAAG,CAAC,UAAU,CAAC,MAAM,CAAC;YAAE,OAAO,WAAW,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,EAAE,GAAG,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAA;QAC7E,IAAI,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE;YACrB,OAAO,WAAW,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAA;SACpC;QACD,OAAO,WAAW,CAAC,GAAG,CAAC,CAAA;KAC1B;IAID,EAAE,CAAC,KAAU;QACT,OAAO,IAAI,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,CAAA;KACxE;IAED,KAAK;QACD,OAAO,IAAI,CAAA;KACd;IAED,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAqE;QAC/E,OAAO,IAAI,GAAG,CACV,CAAC,KAAK,SAAS,GAAG,CAAC,GAAG,IAAI,CAAC,CAAC,EAC5B,CAAC,KAAK,SAAS,GAAG,CAAC,GAAG,IAAI,CAAC,CAAC,EAC5B,CAAC,KAAK,SAAS,GAAG,CAAC,GAAG,IAAI,CAAC,CAAC,CAC/B,CAAA;KACJ;IAED,OAAO;QACH,OAAO,OAAO,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAA;KACrF;IAED,QAAQ;QACJ,OAAO,IAAI,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAA;KAC7E;IAED,QAAQ;QACJ,OAAO,MAAM,GAAG,IAAI,CAAC,CAAC,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC,GAAG,GAAG,CAAA;KAC/D;CACJ;AAED,MAAa,SAAS;IAIlB,YAAqB,CAAS,EAAW,CAAS,EAAW,CAAS;QAAjD,MAAC,GAAD,CAAC,CAAQ;QAAW,MAAC,GAAD,CAAC,CAAQ;QAAW,MAAC,GAAD,CAAC,CAAQ;KAAI;IAE1E,EAAE,CAAC,KAAgB;QACf,OAAO,IAAI,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,CAAA;KACxE;IAED,IAAI,CAAC,EACD,CAAC,EACD,CAAC,EACD,CAAC,GAKJ;QACG,OAAO,IAAI,SAAS,CAChB,CAAC,KAAK,SAAS,GAAG,CAAC,GAAG,IAAI,CAAC,CAAC,EAC5B,CAAC,KAAK,SAAS,GAAG,CAAC,GAAG,IAAI,CAAC,CAAC,EAC5B,CAAC,KAAK,SAAS,GAAG,CAAC,GAAG,IAAI,CAAC,CAAC,CAC/B,CAAA;KACJ;IAED,GAAG,CAAC,GAAW,EAAE,KAAgB;QAC7B,OAAO,IAAI,SAAS,CAChB,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,EAC1B,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,EAC1B,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAC7B,CAAA;KACJ;IAED,OAAO,CAAC,GAAW;QACf,OAAO,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,SAAS,CAAC,KAAK,CAAC,CAAA;KACxC;IAED,MAAM,CAAC,GAAW;QACd,OAAO,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,SAAS,CAAC,KAAK,CAAC,CAAA;KACxC;IAED,UAAU;QACN,OAAO,IAAI,GAAG,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAA;KAC7E;IAED,QAAQ;QACJ,OAAO,YAAY,GAAG,IAAI,CAAC,CAAC,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC,GAAG,GAAG,CAAA;KACrE;;AA/CM,eAAK,GAAG,IAAI,SAAS,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;AAC9B,eAAK,GAAG,IAAI,SAAS,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;AAiDzC,SAAS,QAAQ,CAAC,CAAS;IACvB,OAAO,CAAC,GAAG,OAAO,GAAG,UAAC,CAAC,CAAC,GAAG,KAAK,IAAI,KAAK,GAAK,GAAG,CAAA,GAAG,CAAC,GAAG,KAAK,CAAA;CAChE;AAED,SAAS,UAAU,CAAC,CAAS;IACzB,OAAO,CAAC,IAAI,SAAS,GAAG,CAAC,GAAG,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,KAAK,EAAE,GAAG,GAAG,GAAG,CAAC,GAAG,KAAK,CAAA;CAC7E;AAED,SAAS,WAAW,CAAC,CAAS;IAC1B,OAAO,CAAC,CAAC,GAAG,WAAW,IAAI,CAAC,CAAA;CAC/B;AAED,SAAS,WAAW,CAAC,CAAS,EAAE,CAAS,EAAE,CAAS;IAChD,IAAI,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;QAAE,OAAO,IAAI,CAAA;IACzC,IAAI,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;QAAE,OAAO,IAAI,CAAA;IACzC,IAAI,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;QAAE,OAAO,IAAI,CAAA;IAEzC,OAAO,IAAI,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;CAC1B;AAED,SAAS,WAAW,CAAC,GAAW;IAC5B,MAAM,IAAI,GAAG,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;IAC3B,IAAI,IAAI,CAAC,MAAM,KAAK,CAAC;QAAE,OAAO,IAAI,CAAA;IAElC,MAAM,CAAC,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,CAAA;IAC1C,MAAM,CAAC,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,CAAA;IAC1C,MAAM,CAAC,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,CAAA;IAE1C,OAAO,WAAW,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;CAC9B;AAED,SAAS,WAAW,CAAC,GAAW;IAC5B,IAAI,GAAG,CAAC,MAAM,KAAK,CAAC,EAAE;QAClB,MAAM,CAAC,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE,CAAA;QAC/B,MAAM,CAAC,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE,CAAA;QAC/B,MAAM,CAAC,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE,CAAA;QAC/B,OAAO,WAAW,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;KAC9B;IACD,IAAI,GAAG,CAAC,MAAM,KAAK,CAAC,EAAE;QAClB,MAAM,CAAC,GAAG,YAAY,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,CAAA;QACtC,MAAM,CAAC,GAAG,YAAY,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,CAAA;QACtC,MAAM,CAAC,GAAG,YAAY,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,CAAA;QACtC,OAAO,WAAW,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;KAC9B;IACD,OAAO,IAAI,CAAA;CACd;AAED,SAAS,YAAY,CAAC,CAAS,EAAE,CAAS;IACtC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC,GAAG,EAAE,GAAG,QAAQ,CAAC,CAAC,CAAC,IAAI,GAAG,CAAA;CAChD;AAED,SAAS,QAAQ,CAAC,GAAW;IACzB,MAAM,KAAK,GAAG,GAAG,CAAC,WAAW,EAAE,CAAA;IAC/B,QAAQ,KAAK;QACT,KAAK,GAAG;YACJ,OAAO,CAAC,CAAA;QACZ,KAAK,GAAG;YACJ,OAAO,CAAC,CAAA;QACZ,KAAK,GAAG;YACJ,OAAO,CAAC,CAAA;QACZ,KAAK,GAAG;YACJ,OAAO,CAAC,CAAA;QACZ,KAAK,GAAG;YACJ,OAAO,CAAC,CAAA;QACZ,KAAK,GAAG;YACJ,OAAO,CAAC,CAAA;QACZ,KAAK,GAAG;YACJ,OAAO,CAAC,CAAA;QACZ,KAAK,GAAG;YACJ,OAAO,CAAC,CAAA;QACZ,KAAK,GAAG;YACJ,OAAO,CAAC,CAAA;QACZ,KAAK,GAAG;YACJ,OAAO,CAAC,CAAA;QACZ,KAAK,GAAG;YACJ,OAAO,EAAE,CAAA;QACb,KAAK,GAAG;YACJ,OAAO,EAAE,CAAA;QACb,KAAK,GAAG;YACJ,OAAO,EAAE,CAAA;QACb,KAAK,GAAG;YACJ,OAAO,EAAE,CAAA;QACb,KAAK,GAAG;YACJ,OAAO,EAAE,CAAA;QACb,KAAK,GAAG;YACJ,OAAO,EAAE,CAAA;QACb;YACI,OAAO,GAAG,CAAA;KACjB;CACJ;AAED,SAAS,IAAI,CAAC,GAAW,EAAE,IAAY,EAAE,EAAU;IAC/C,OAAO,IAAI,GAAG,GAAG,GAAG,EAAE,CAAA;CACzB;;MC5LY,GAAG;IAGZ,YAAqB,CAAS,EAAW,CAAS,EAAW,CAAS;QAAjD,MAAC,GAAD,CAAC,CAAQ;QAAW,MAAC,GAAD,CAAC,CAAQ;QAAW,MAAC,GAAD,CAAC,CAAQ;QAF9D,gBAAW,GAAe,IAAI,CAAA;KAEoC;IAE1E,EAAE,CAAC,KAAU;QACT,OAAO,IAAI,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,CAAA;KACxE;IAED,KAAK;QACD,IAAI,IAAI,CAAC,WAAW,KAAK,IAAI,EAAE;YAC3B,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,IAAI,CAAC,CAAA;SACpC;QACD,OAAO,IAAI,CAAC,WAAW,CAAA;KAC1B;IAED,OAAO;QACH,OAAO,IAAI,CAAC,KAAK,EAAE,CAAC,OAAO,EAAE,CAAA;KAChC;IAED,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAqE;QAC/E,OAAO,IAAI,GAAG,CACV,CAAC,KAAK,SAAS,GAAG,CAAC,GAAG,IAAI,CAAC,CAAC,EAC5B,CAAC,KAAK,SAAS,GAAG,CAAC,GAAG,IAAI,CAAC,CAAC,EAC5B,CAAC,KAAK,SAAS,GAAG,CAAC,GAAG,IAAI,CAAC,CAAC,CAC/B,CAAA;KACJ;IAED,QAAQ;QACJ,OAAO,MAAM,GAAG,IAAI,CAAC,CAAC,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC,GAAG,GAAG,CAAA;KAC/D;CACJ;AAED,SAAgB,QAAQ,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAO;IACrC,MAAM,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;IAClC,MAAM,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;IAClC,MAAM,CAAC,GAAG,QAAQ,GAAG,QAAQ,CAAA;IAC7B,MAAM,CAAC,GAAG,QAAQ,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,QAAQ,CAAA;IAC3C,IAAI,CAAS,CAAA;IAEb,QAAQ,QAAQ;QACZ,KAAK,QAAQ;YACT,CAAC,GAAG,CAAC,CAAA;YACL,MAAK;QACT,KAAK,CAAC;YACF,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,GAAG,GAAG,GAAG,CAAC,CAAA;YACrC,MAAK;QACT,KAAK,CAAC;YACF,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,GAAG,CAAA;YACrB,MAAK;QACT;YACI,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,GAAG,CAAA;YACrB,MAAK;KACZ;IACD,OAAO,IAAI,GAAG,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,QAAQ,CAAC,CAAA;CACrC;AAED,SAAgB,QAAQ,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAO;IACrC,MAAM,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAA;IACrB,MAAM,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAA;IACnB,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAA;IACrB,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAA;IACzB,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAA;IAE/B,IAAI,CAAS,CAAA;IACb,IAAI,CAAS,CAAA;IACb,IAAI,CAAS,CAAA;IACb,QAAQ,CAAC,GAAG,CAAC;QACT,KAAK,CAAC;YACF,CAAC,GAAG,CAAC,CAAA;YACL,CAAC,GAAG,CAAC,CAAA;YACL,CAAC,GAAG,CAAC,CAAA;YACL,MAAK;QACT,KAAK,CAAC;YACF,CAAC,GAAG,CAAC,CAAA;YACL,CAAC,GAAG,CAAC,CAAA;YACL,CAAC,GAAG,CAAC,CAAA;YACL,MAAK;QACT,KAAK,CAAC;YACF,CAAC,GAAG,CAAC,CAAA;YACL,CAAC,GAAG,CAAC,CAAA;YACL,CAAC,GAAG,CAAC,CAAA;YACL,MAAK;QACT,KAAK,CAAC;YACF,CAAC,GAAG,CAAC,CAAA;YACL,CAAC,GAAG,CAAC,CAAA;YACL,CAAC,GAAG,CAAC,CAAA;YACL,MAAK;QACT,KAAK,CAAC;YACF,CAAC,GAAG,CAAC,CAAA;YACL,CAAC,GAAG,CAAC,CAAA;YACL,CAAC,GAAG,CAAC,CAAA;YACL,MAAK;QACT;YACI,CAAC,GAAG,CAAC,CAAA;YACL,CAAC,GAAG,CAAC,CAAA;YACL,CAAC,GAAG,CAAC,CAAA;YACL,MAAK;KACZ;IACD,OAAO,IAAI,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;CAC1B;;ACpGD;;;;;;;;;;;;;;AAeA,MAAM,IAAI;IAGN,YAAqB,CAAS,EAAW,CAAS;QAA7B,MAAC,GAAD,CAAC,CAAQ;QAAW,MAAC,GAAD,CAAC,CAAQ;KAAI;CACzD;AAED,MAAM,IAAI;IAGN,YAAqB,CAAS,EAAW,CAAS,EAAW,CAAS;QAAjD,MAAC,GAAD,CAAC,CAAQ;QAAW,MAAC,GAAD,CAAC,CAAQ;QAAW,MAAC,GAAD,CAAC,CAAQ;KAAI;CAC7E;AAED,MAAa,GAAG;IAGZ,YAAqB,CAAS,EAAW,CAAS,EAAW,CAAS;QAAjD,MAAC,GAAD,CAAC,CAAQ;QAAW,MAAC,GAAD,CAAC,CAAQ;QAAW,MAAC,GAAD,CAAC,CAAQ;KAAI;CAC7E;AAED,MAAa,KAAK;IAGd,YAAqB,CAAS,EAAW,CAAS,EAAW,CAAS;QAAjD,MAAC,GAAD,CAAC,CAAQ;QAAW,MAAC,GAAD,CAAC,CAAQ;QAAW,MAAC,GAAD,CAAC,CAAQ;QAF9D,gBAAW,GAAe,IAAI,CAAA;KAEoC;IAE1E,EAAE,CAAC,KAAY;QACX,OAAO,IAAI,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,CAAA;KACxE;IAED,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAqE;QAC/E,OAAO,IAAI,KAAK,CACZ,CAAC,KAAK,SAAS,GAAG,CAAC,GAAG,IAAI,CAAC,CAAC,EAC5B,CAAC,KAAK,SAAS,GAAG,CAAC,GAAG,IAAI,CAAC,CAAC,EAC5B,CAAC,KAAK,SAAS,GAAG,CAAC,GAAG,IAAI,CAAC,CAAC,CAC/B,CAAA;KACJ;IAED,KAAK;QACD,IAAI,IAAI,CAAC,WAAW,KAAK,IAAI,EAAE;YAC3B,IAAI,CAAC,WAAW,GAAG,UAAU,CAAC,IAAI,CAAC,CAAA;SACtC;QACD,OAAO,IAAI,CAAC,WAAW,CAAA;KAC1B;IAED,OAAO;QACH,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,EAAE,CAAC,OAAO,EAAE,CAAA;QACpC,OAAO,KAAK,CAAA;KACf;IAED,QAAQ;QACJ,OAAO,QAAQ,GAAG,IAAI,CAAC,CAAC,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC,GAAG,GAAG,CAAA;KACjE;CACJ;AAED,MAAa,KAAK;IAGd,YAAqB,CAAS,EAAW,CAAS,EAAW,CAAS;QAAjD,MAAC,GAAD,CAAC,CAAQ;QAAW,MAAC,GAAD,CAAC,CAAQ;QAAW,MAAC,GAAD,CAAC,CAAQ;QAF9D,gBAAW,GAAe,IAAI,CAAA;KAEoC;IAE1E,EAAE,CAAC,KAAY;QACX,OAAO,IAAI,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,CAAA;KACxE;IAED,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAqE;QAC/E,OAAO,IAAI,KAAK,CACZ,CAAC,KAAK,SAAS,GAAG,CAAC,GAAG,IAAI,CAAC,CAAC,EAC5B,CAAC,KAAK,SAAS,GAAG,CAAC,GAAG,IAAI,CAAC,CAAC,EAC5B,CAAC,KAAK,SAAS,GAAG,CAAC,GAAG,IAAI,CAAC,CAAC,CAC/B,CAAA;KACJ;IAED,KAAK;QACD,IAAI,IAAI,CAAC,WAAW,KAAK,IAAI,EAAE;YAC3B,IAAI,CAAC,WAAW,GAAG,UAAU,CAAC,IAAI,CAAC,CAAA;SACtC;QACD,OAAO,IAAI,CAAC,WAAW,CAAA;KAC1B;IAED,OAAO;QACH,OAAO,IAAI,CAAC,KAAK,EAAE,CAAC,OAAO,EAAE,CAAA;KAChC;IAED,QAAQ;QACJ,OAAO,MAAM,GAAG,IAAI,CAAC,CAAC,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC,GAAG,GAAG,CAAA;KAC/D;CACJ;AAED,MAAa,GAAG;IAGZ,YAAqB,CAAS,EAAW,CAAS,EAAW,CAAS;QAAjD,MAAC,GAAD,CAAC,CAAQ;QAAW,MAAC,GAAD,CAAC,CAAQ;QAAW,MAAC,GAAD,CAAC,CAAQ;KAAI;CAC7E;AAED,MAAa,GAAG;IAGZ,YAAqB,CAAS,EAAW,CAAS,EAAW,CAAS;QAAjD,MAAC,GAAD,CAAC,CAAQ;QAAW,MAAC,GAAD,CAAC,CAAQ;QAAW,MAAC,GAAD,CAAC,CAAQ;KAAI;CAC7E;;;;;;;;;;;;;;AAuBD,MAAM,CAAC,GAAS;IACZ,IAAI,IAAI,CAAC,iBAAiB,EAAE,CAAC,iBAAiB,EAAE,CAAC,cAAc,CAAC;IAChE,IAAI,IAAI,CAAC,CAAC,gBAAgB,EAAE,gBAAgB,EAAE,iBAAiB,CAAC;IAChE,IAAI,IAAI,CAAC,iBAAiB,EAAE,CAAC,gBAAgB,EAAE,iBAAiB,CAAC;CACpE,CAAA;AAED,MAAM,IAAI,GAAS;IACf,IAAI,IAAI,CAAC,gBAAgB,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;IAC9D,IAAI,IAAI,CAAC,gBAAgB,EAAE,gBAAgB,EAAE,iBAAiB,CAAC;IAC/D,IAAI,IAAI,CAAC,iBAAiB,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;CAClE,CAAA;AAED,MAAM,IAAI,GAAW,GAAG,CAAA;AAExB,MAAM,IAAI,GAAW,gBAAgB,CAAA;AAErC,MAAM,IAAI,GAAW,gBAAgB,CAAA;AAErC,MAAM,KAAK,GAAW,WAAW,CAAA;AAEjC,MAAM,OAAO,GAAW,YAAY,CAAA;AAEpC,SAAS,gBAAgB,CAAC,GAAW;IACjC,OAAO,CAAC,GAAG,GAAG,IAAI,CAAC,EAAE,IAAI,KAAK,CAAA;CACjC;AAED,SAAS,gBAAgB,CAAC,GAAW;IACjC,OAAO,CAAC,GAAG,GAAG,KAAK,IAAI,IAAI,CAAC,EAAE,CAAA;CACjC;AAED,SAAS,yBAAyB,CAAC,KAAa,EAAE,GAAS;IACvD,MAAM,MAAM,GAAG,GAAG,CAAC,CAAC,IAAI,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAA;IAClE,IAAI,MAAM,GAAG,GAAG,EAAE;QACd,OAAO,CAAC,MAAM,CAAA;KACjB;SAAM;QACH,OAAO,MAAM,CAAA;KAChB;CACJ;AAID,SAAS,SAAS,CAAC,CAAS;IACxB,MAAM,IAAI,GAAG,UAAC,CAAC,GAAG,EAAE,GAAK,CAAC,CAAA,GAAG,OAAO,CAAA;IACpC,MAAM,IAAI,GAAG,IAAI,GAAG,OAAO,GAAG,IAAI,GAAG,CAAC,GAAG,KAAK,CAAA;IAE9C,MAAM,MAAM,GAAG,IAAI,KAAK,CAAO,CAAC,GAAG,CAAC,CAAC,CAAA;;;IAIrC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;QACxB,MAAM,EAAE,GAAG,CAAC,CAAC,CAAc,CAAC,CAAC,CAAC,CAAA;QAC9B,MAAM,EAAE,GAAG,CAAC,CAAC,CAAc,CAAC,CAAC,CAAC,CAAA;QAC9B,MAAM,EAAE,GAAG,CAAC,CAAC,CAAc,CAAC,CAAC,CAAC,CAAA;QAE9B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;YACxB,MAAM,IAAI,GAAG,CAAC,MAAM,GAAG,EAAE,GAAG,KAAK,GAAG,EAAE,IAAI,IAAI,CAAA;YAC9C,MAAM,IAAI,GAAG,CAAC,MAAM,GAAG,EAAE,GAAG,MAAM,GAAG,EAAE,GAAG,MAAM,GAAG,EAAE,IAAI,CAAC,GAAG,IAAI,GAAG,MAAM,GAAG,CAAC,GAAG,CAAC,CAAA;YAClF,MAAM,MAAM,GAAG,CAAC,MAAM,GAAG,EAAE,GAAG,MAAM,GAAG,EAAE,IAAI,IAAI,GAAG,MAAM,GAAG,CAAC,CAAA;YAC9D,MAAM,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,IAAI,CAAC,IAAI,GAAG,MAAM,EAAE,IAAI,GAAG,MAAM,CAAC,CAAA;SAC7D;KACJ;IAED,OAAO,MAAM,CAAA;CAChB;AAED,SAAS,QAAQ,CAAC,CAAS,EAAE,CAAS;IAClC,OAAO,IAAI,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAA;CAClC;AAED,SAAS,iBAAiB,CAAC,IAAU,EAAE,IAAU;IAC7C,OAAO,CAAC,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAA;CAC/C;AAED,SAAS,iBAAiB,CAAC,CAAS;IAChC,MAAM,MAAM,GAAG,SAAS,CAAC,CAAC,CAAC,CAAA;IAE3B,IAAI,GAAG,GAAG,MAAM,CAAC,SAAS,CAAA;IAE1B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;QACxB,MAAM,IAAI,GAAG,MAAM,CAAC,CAAC,CAAC,CAAA;;QAGtB,MAAM,CAAC,GAAG,iBAAiB,CAAC,IAAI,EAAE,IAAI,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAA;QAE3D,MAAM,MAAM,GAAG,QAAQ,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAA;QAE/C,IAAI,MAAM,GAAG,GAAG;YAAE,GAAG,GAAG,MAAM,CAAA;KACjC;IAED,OAAO,GAAG,CAAA;CACb;AAED,SAAS,cAAc,CAAC,CAAS,EAAE,CAAS;IACxC,MAAM,IAAI,GAAG,CAAC,CAAC,GAAG,KAAK,IAAI,IAAI,CAAC,EAAE,GAAG,GAAG,CAAA;IACxC,MAAM,MAAM,GAAG,SAAS,CAAC,CAAC,CAAC,CAAA;IAE3B,IAAI,GAAG,GAAG,MAAM,CAAC,SAAS,CAAA;IAC1B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;;QAEpC,MAAM,MAAM,GAAG,yBAAyB,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC,CAAA;QAEzD,IAAI,MAAM,IAAI,CAAC,IAAI,MAAM,GAAG,GAAG;YAAE,GAAG,GAAG,MAAM,CAAA;KAChD;IACD,OAAO,GAAG,CAAA;CACb;AAED,SAAS,IAAI,CAAC,CAAS;IACnB,IAAI,CAAC,GAAG,OAAO,EAAE;QACb,OAAO,GAAG,GAAG,UAAC,CAAC,GAAG,IAAI,IAAM,CAAC,GAAG,CAAC,EAAC,GAAG,EAAE,CAAA;KAC1C;SAAM;QACH,OAAO,CAAC,CAAC,GAAG,IAAI,IAAI,KAAK,CAAA;KAC5B;CACJ;AAED,SAAS,OAAO,CAAC,CAAS;IACtB,IAAI,CAAC,GAAG,GAAG,EAAE;QACT,OAAO,UAAC,IAAI,IAAI,CAAC,CAAC,GAAG,IAAI,IAAI,KAAK,CAAC,GAAK,GAAG,CAAA,CAAA;KAC9C;SAAM;QACH,OAAO,CAAC,IAAI,GAAG,CAAC,IAAI,KAAK,CAAA;KAC5B;CACJ;AAED,SAASA,YAAU,CAAC,CAAS;IACzB,IAAI,CAAC,IAAI,SAAS,EAAE;QAChB,OAAO,KAAK,GAAG,CAAC,CAAA;KACnB;SAAM;QACH,OAAO,KAAK,GAAG,SAAA,CAAC,GAAK,GAAG,GAAG,GAAG,EAAC,GAAG,KAAK,CAAA;KAC1C;CACJ;AAED,SAAgB,QAAQ,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAO;IACrC,MAAM,CAAC,GAAG,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,CAAA;IACxB,IAAI,CAAC,GAAG,UAAU,EAAE;QAChB,OAAO,IAAI,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;KAC1B;IACD,MAAM,CAAC,GAAG,gBAAgB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAA;IAC5C,IAAI,CAAC,GAAG,GAAG,EAAE;QACT,OAAO,IAAI,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,CAAA;KAChC;SAAM;QACH,OAAO,IAAI,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;KAC1B;CACJ;AAED,SAAgB,QAAQ,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAO;IACrC,MAAM,IAAI,GAAG,gBAAgB,CAAC,CAAC,CAAC,CAAA;IAChC,MAAM,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;IAC5B,MAAM,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;IAC5B,OAAO,IAAI,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;CAC1B;AAED,SAAS,OAAO,CAAI,EAAkB,EAAE,GAAS;IAC7C,OAAO,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAA;CAC9C;AAED,SAAgB,QAAQ,CAAC,GAAQ;IAC7B,MAAM,IAAI,GAAG,GAAG,CAAC,QAAQ,EAAE,CAAA;;IAE3B,MAAM,GAAG,GAAG,OAAO,CAAC,GAAG,IAAI,IAAI,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,CAAA;IAClF,OAAO,IAAI,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,CAAA;CACzC;AAED,SAAgB,QAAQ,CAAC,GAAQ;;IAE7B,MAAM,GAAG,GAAG,OAAO,CAAC,GAAG,IAAIA,YAAU,CAAC,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAA;IACxF,OAAO,IAAI,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,CAAA;CACzC;AAED,SAAgB,UAAU,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAO;IACvC,IAAI,CAAC,GAAG,UAAU,EAAE;QAChB,OAAO,IAAI,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC,CAAA;KAC9B;IACD,IAAI,CAAC,GAAG,UAAU,EAAE;QAChB,OAAO,IAAI,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;KAC5B;IACD,MAAM,EAAE,GAAG,cAAc,CAAC,CAAC,EAAE,CAAC,CAAC,CAAA;IAC/B,MAAM,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,IAAI,GAAG,CAAA;IACxB,OAAO,IAAI,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;CAC5B;AAED,SAAgB,UAAU,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAS;IACzC,IAAI,CAAC,GAAG,UAAU,EAAE;QAChB,OAAO,IAAI,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC,CAAA;KAC9B;IACD,IAAI,CAAC,GAAG,UAAU,EAAE;QAChB,OAAO,IAAI,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;KAC1B;IACD,MAAM,EAAE,GAAG,cAAc,CAAC,CAAC,EAAE,CAAC,CAAC,CAAA;IAC/B,MAAM,CAAC,GAAG,CAAC,EAAE,GAAG,GAAG,IAAI,CAAC,CAAA;IACxB,OAAO,IAAI,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;CAC1B;AAED,SAAgB,UAAU,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAO;IACvC,IAAI,CAAC,GAAG,UAAU,EAAE;QAChB,OAAO,IAAI,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC,CAAA;KAC9B;IACD,IAAI,CAAC,GAAG,UAAU,EAAE;QAChB,OAAO,IAAI,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;KAC5B;IAED,MAAM,EAAE,GAAG,iBAAiB,CAAC,CAAC,CAAC,CAAA;IAC/B,MAAM,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,IAAI,GAAG,CAAA;IACxB,OAAO,IAAI,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;CAC5B;AAED,SAAgB,UAAU,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAS;IACzC,IAAI,CAAC,GAAG,UAAU,EAAE;QAChB,OAAO,IAAI,GAAG,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;KAC5B;IACD,IAAI,CAAC,GAAG,UAAU,EAAE;QAChB,OAAO,IAAI,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;KAC1B;IACD,MAAM,EAAE,GAAG,iBAAiB,CAAC,CAAC,CAAC,CAAA;IAC/B,MAAM,CAAC,GAAG,CAAC,EAAE,GAAG,GAAG,IAAI,CAAC,CAAA;IACxB,OAAO,IAAI,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;CAC1B;AAED,SAAgB,QAAQ,CAAC,GAAQ;IAC7B,OAAO,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAA;CACjC;AAED,SAAgB,QAAQ,CAAC,GAAQ;IAC7B,OAAO,QAAQ,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;CAC3C;AAED,SAAgB,QAAQ,CAAC,GAAQ;IAC7B,OAAO,QAAQ,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;CAC3C;AAED,SAAgB,UAAU,CAAC,GAAQ;IAC/B,OAAO,UAAU,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAA;CACnC;AAED,SAAgB,UAAU,CAAC,KAAY;IACnC,OAAO,QAAQ,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,CAAA;CACrC;AAED,SAAgB,UAAU,CAAC,GAAQ;IAC/B,OAAO,UAAU,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAA;CACnC;AAED,SAAgB,UAAU,CAAC,KAAY;IACnC,OAAO,QAAQ,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,CAAA;CACrC;AAED,SAAgB,QAAQ,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAO;IACrC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;QAC/B,OAAO,IAAI,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;KAC1B;IACD,MAAM,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAA;IACjB,IAAI,CAAC,KAAK,CAAC,EAAE;QACT,OAAO,IAAI,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;KAC1B;IAED,MAAM,CAAC,GAAG,EAAE,GAAG,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,EAAE,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,CAAA;IAC1D,MAAM,CAAC,GAAG,EAAE,GAAG,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,EAAE,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,CAAA;IAC1D,OAAO,IAAI,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;CAC1B;AAED,SAAgB,QAAQ,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAO;IACrC,IAAI,CAAC,KAAK,CAAC,EAAE;QACT,OAAO,IAAI,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;KAC1B;IAED,MAAM,KAAK,GAAG,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC,GAAG,IAAI,CAAA;IACjC,MAAM,KAAK,GAAG,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC,GAAG,IAAI,CAAA;IAEjC,MAAM,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC,GAAG,IAAI,CAAA;IAC3B,MAAM,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,KAAK,KAAK,CAAC,KAAK,GAAG,CAAC,IAAI,KAAK,GAAG,KAAK,GAAG,KAAK,CAAC,CAAA;IACrE,MAAM,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,EAAE,GAAG,KAAK,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,KAAK,CAAC,GAAG,KAAK,CAAC,CAAA;IAC5D,OAAO,IAAI,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;CAC1B;AAED,SAAgB,MAAM,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAO;IACnC,MAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,CAAC,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,GAAG,CAAC,CAAC,CAAA;IACrE,OAAO,IAAI,GAAG,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAA;CACnC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}